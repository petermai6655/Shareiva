"use strict";var WPFormsFormAbandonment=window.WPFormsFormAbandonment||function(e,n,a){var t={},i=!1,o=!1,r={mobileDetect:null,init:function(){"undefined"!=typeof MobileDetect&&(r.mobileDetect=new MobileDetect(n.navigator.userAgent)),a(e).on("input",".wpforms-form-abandonment :input",r.prepData),a(e).on("change",".wpforms-form-abandonment input[type=radio]",r.prepData),a(e).on("change",".wpforms-form-abandonment input[type=checkbox]",r.prepData),a(e).on("change",".wpforms-form-abandonment .wpforms-timepicker",r.prepData),a(e).on("mouseleave",this.abandonMouse),r.isMobileDevice()?(r.isIOSDevice()&&a("a").css("cursor","pointer"),a(e).on("click",this.abandonClick)):a(e).on("mousedown",this.abandonClick),a(n).on("beforeunload",this.abandonBeforeUnload)},isMobileDevice:function(){return!!r.mobileDetect&&!!r.mobileDetect.mobile()},isIOSDevice:function(){return!!r.mobileDetect&&"iOS"===r.mobileDetect.os()},prepData:function(e){var n=a(e.target).closest(".wpforms-form"),o=n.data("formid");t[o]=n.serializeArray(),i=JSON.stringify(t),r.debug("Preping data")},sendData:function(){i&&!o&&(o=!0,setTimeout(function(){o=!1},1e4),r.debug("Sending"),a.post(wpforms_form_abandonment.ajaxurl,{action:"wpforms_form_abandonment",forms:i}),i=!(t={}))},abandonMouse:function(e){e.offsetX<-1||20<e.clientY||(r.debug("Mouse abandoned"),r.sendData())},abandonClick:function(e){for(var n=e.srcElement||e.target;n&&(void 0===n.tagName||"a"!==n.tagName.toLowerCase()||!n.href);)n=n.parentNode;if(n&&n.href){r.debug("Click abandoned");var o=n.href,a="internal";if("mailto"===n.protocol?a="mailto":-1===o.indexOf(wpforms_form_abandonment.home_url)&&(a="external"),!(["external","internal"].indexOf(a)<0||o.match(/^javascript\:/i))){var t=!(!n.target||n.target.match(/^_(self|parent|top)$/i))&&n.target;(e.ctrlKey||e.shiftKey||e.metaKey||2===e.which)&&(t="_blank"),(t||r.isIOSDevice())&&r.sendData()}}},abandonBeforeUnload:function(e){r.debug("Before unload abandoned"),r.sendData()},debug:function(e){n.location.hash&&"#wpformsfadebug"===n.location.hash&&console.log("WPForms FA: "+e)}};return r}(document,window,jQuery);WPFormsFormAbandonment.init();